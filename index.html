<!DOCTYPE html>
<html lang="pt-PT">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App de Treino de Wing Chun | Vers√£o Profissional</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Teko:wght@400;600;700&display=swap"
        rel="stylesheet">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Overlay for mobile menu -->
    <div id="mobile-menu-overlay"></div>

    <!-- Main application layout -->
    <div class="app-layout">
        <!-- Responsive Sidebar -->
        <aside id="app-sidebar" class="app-sidebar">
            <div class="sidebar-header">
                <img src="https://placehold.co/100x100/e67e22/FFFFFF?text=WC" alt="Logo de Wing Chun"
                    class="sidebar-logo">
                <h1 id="app-title" class="sidebar-title">Wing Chun App</h1>
                <!-- Mobile close button -->
                <button id="close-menu-btn" class="icon-button close" aria-label="Fechar menu">
                     <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <nav id="navigation-hub" class="sidebar-nav"></nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Mobile Header -->
            <header id="mobile-header" class="mobile-header">
                <button id="open-menu-btn" class="icon-button" aria-label="Abrir menu">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
                <h2 id="current-section-title" class="mobile-header-title">Perfil</h2>
            </header>

            <!-- User Status Bar -->
            <div id="user-status-display" style="display: none;">
                <img id="user-status-avatar" src="https://placehold.co/100x100/2c2c2c/ecf0f1?text=U" alt="Avatar do Utilizador">
                <div class="user-info">
                    <span id="user-status-name">Praticante</span>
                    <span id="user-status-belt">Cintur√£o Branco</span>
                </div>
                <div class="progress-bar-wrapper">
                    <div id="user-progress-bar-text" class="progress-bar-text">0 / 250 XP</div>
                    <div class="progress-bar-container">
                        <div id="user-progress-bar-fill" class="progress-bar-fill"></div>
                    </div>
                </div>
                <div class="progress-bar-wrapper">
                    <div id="stamina-bar-text" class="progress-bar-text">‚ö° 100 / 100</div>
                    <div class="progress-bar-container">
                        <div id="stamina-bar-fill" class="progress-bar-fill"></div>
                    </div>
                </div>
            </div>

            <!-- Scrollable Content Area -->
            <main id="main-content-area" class="main-content-area">
                <div class="main-content-wrapper">
                    <section id="seccao-perfil" class="seccao visivel">
                        <!-- Profile creation view -->
                        <div id="perfil-form-view">
                           <div class="floating-card">
                                <div class="card-header">
                                    <h1 class="titulo-seccao">Cria o Teu Perfil</h1>
                                </div>
                                <div class="card-content">
                                    <div class="perfil-form-layout">
                                        <div class="form-fields">
                                            <label for="perfil-nome">Nome:</label>
                                            <input type="text" id="perfil-nome" placeholder="O teu nome de praticante">
                                            <div class="form-row">
                                                <div>
                                                    <label for="perfil-altura">Altura (cm):</label>
                                                    <input type="number" id="perfil-altura" placeholder="Ex: 175">
                                                </div>
                                                <div>
                                                    <label for="perfil-peso">Peso (kg):</label>
                                                    <input type="number" id="perfil-peso" step="0.1" placeholder="Ex: 70.5">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-avatar-selection">
                                            <h3>Escolhe o teu Avatar:</h3>
                                            <img id="form-avatar-preview" src="https://placehold.co/150x150/2c2c2c/ecf0f1?text=?" alt="Pr√©-visualiza√ß√£o do Avatar">
                                            <div id="avatar-choices-grid" class="avatar-choices-grid"></div>
                                        </div>
                                    </div>
                                    <button id="guardarPerfilBtn" class="action-button perfil-action-button">Guardar e Come√ßar</button>
                                </div>
                            </div>
                        </div>

                        <!-- Profile dashboard view -->
                        <div id="perfil-dashboard-view" style="display: none;">
                            <div class="profile-tabs">
                                <button class="profile-tab-btn active" data-tab="passaporte">Passaporte</button>
                                <button class="profile-tab-btn" data-tab="estatisticas">Estat√≠sticas</button>
                                <button class="profile-tab-btn" data-tab="desafio">Desafio Di√°rio</button>
                            </div>
                            <div id="profile-tab-content">
                                <div id="tab-pane-passaporte" class="profile-tab-pane active">
                                    <div class="floating-card">
                                         <div class="card-header">
                                            <h1 class="titulo-seccao">O Teu Passaporte</h1>
                                        </div>
                                        <div class="card-content">
                                            <div class="passaporte-layout">
                                                <img id="passaporte-avatar-display" src="https://placehold.co/150x150/2c2c2c/ecf0f1?text=U" alt="Avatar">
                                                <div class="passaporte-info">
                                                    <p><strong>Nome:</strong> <span id="passaporte-nome"></span></p>
                                                    <p><strong>N√≠vel:</strong> <span id="passaporte-belt"></span></p>
                                                    <p><strong>XP Total:</strong> <span id="passaporte-pontos"></span></p>
                                                    <p><strong>ID de Aluno:</strong> <span id="student-id-display"></span></p>
                                                    <p><strong>Altura:</strong> <span id="passaporte-altura"></span> cm</p>
                                                    <p><strong>Peso:</strong> <span id="passaporte-peso"></span> kg</p>
                                                    <p><strong>IMC:</strong> <span id="passaporte-imc"></span></p>
                                                    <p><strong>Sequ√™ncia:</strong> <span id="passaporte-streak"></span> üî•</p>
                                                    <p><strong>Conquistas:</strong> <span id="passaporte-achievements"></span> üèÜ</p>
                                                </div>
                                            </div>
                                            <div class="profile-action-buttons">
                                                <button id="editarPerfilBtn" class="action-button">Editar Perfil</button>
                                                <button id="exportProfileBtn" class="action-button">Exportar Dados</button>
                                                <button id="importProfileBtn" class="action-button">Importar Dados</button>
                                            </div>
                                            <div id="theme-picker-container" class="theme-picker">
                                                <h4>Mudar Tema</h4>
                                                <div class="theme-options"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab-pane-estatisticas" class="profile-tab-pane">
                                    <div class="stats-grid">
                                        <div class="stat-card">
                                            <div id="stat-total-xp" class="stat-value">0</div>
                                            <div class="stat-label">XP Total</div>
                                        </div>
                                        <div class="stat-card">
                                            <div id="stat-total-time" class="stat-value">0m</div>
                                            <div class="stat-label">Tempo de Treino</div>
                                        </div>
                                        <div class="stat-card">
                                            <div id="stat-fav-exercise" class="stat-value">-</div>
                                            <div class="stat-label">Exerc√≠cio Favorito</div>
                                        </div>
                                    </div>
                                    <div id="xp-chart-container" class="floating-card">
                                        <canvas id="xp-chart"></canvas>
                                    </div>
                                </div>
                                <div id="tab-pane-desafio" class="profile-tab-pane">
                                     <div id="daily-challenge-card"></div>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <section id="seccao-planos" class="seccao">
                        <h1 class="titulo-seccao">Planos de Treino</h1>
                        <div class="profile-tabs">
                            <button class="profile-tab-btn active" data-tab="recomendado">Recomendados</button>
                            <button class="profile-tab-btn" data-tab="manual">Manuais</button>
                        </div>
                        <div id="planos-tab-content">
                            <div id="tab-pane-recomendado" class="profile-tab-pane active">
                                <div class="profile-tabs" id="recommended-plan-categories">
                                    <button class="profile-tab-btn active" data-category="conditioning">Condicionamento</button>
                                    <button class="profile-tab-btn" data-category="skill">Skill</button>
                                    <button class="profile-tab-btn" data-category="mix">Mix</button>
                                </div>
                                <div id="recommended-plans-container"></div>
                            </div>
                            <div id="tab-pane-manual" class="profile-tab-pane">
                                <div class="floating-card">
                                    <div class="card-header"><h2 class="subtitulo-seccao" style="margin:0; border:0;">Criador de Planos Manuais</h2></div>
                                    <div class="card-content plan-creator-form">
                                        <div class="form-row">
                                            <div style="flex-grow: 2;">
                                                <label for="plan-name-input">Nome do Plano:</label>
                                                <input type="text" id="plan-name-input" placeholder="Ex: Treino Matinal">
                                            </div>
                                        </div>
                                        <div>
                                            <label>Selecionar Exerc√≠cios e Dura√ß√£o (em segundos):</label>
                                            <div id="plan-exercise-selection" class="exercise-selection-grid"></div>
                                        </div>
                                        <button id="save-plan-btn" class="action-button">Guardar Plano</button>
                                    </div>
                                </div>
                                <h2 class="subtitulo-seccao">Os Teus Planos Manuais</h2>
                                <div id="saved-plans-container" class="card-grid"></div>
                            </div>
                        </div>
                    </section>

                    <section id="seccao-mestres" class="seccao">
                        <h1 class="titulo-seccao">Mestres Lend√°rios</h1>
                        <div id="container-mestres" class="card-grid"></div>
                    </section>

                    <section id="seccao-teoria" class="seccao">
                        <h1 class="titulo-seccao">Teoria e Filosofia</h1>
                        <div id="container-teoria" class="card-prose"></div>
                    </section>

                    <section id="seccao-cinturoes" class="seccao">
                        <h1 class="titulo-seccao">Progress√£o de Cintur√µes</h1>
                        <div id="belt-progression-container" class="belt-accordion"></div>
                    </section>

                    <section id="seccao-skill" class="seccao">
                        <h1 class="titulo-seccao">Biblioteca de Skill</h1>
                        <div id="container-skill"></div>
                    </section>

                    <section id="seccao-condicionamento" class="seccao">
                        <h1 class="titulo-seccao">Biblioteca de Condicionamento</h1>
                        <div id="container-condicionamento"></div>
                    </section>

                    <section id="seccao-glossario" class="seccao">
                        <h1 class="titulo-seccao">Gloss√°rio</h1>
                        <div class="profile-tabs">
                            <button class="profile-tab-btn active" data-tab="cinto">Gloss√°rio do Cinto</button>
                            <button class="profile-tab-btn" data-tab="global">Gloss√°rio Global</button>
                        </div>
                        <div id="glossario-tab-content">
                            <div id="tab-pane-cinto" class="profile-tab-pane active">
                                <div id="container-glossario-cinto"></div>
                            </div>
                            <div id="tab-pane-global" class="profile-tab-pane">
                                <div id="container-glossario-global"></div>
                            </div>
                        </div>
                    </section>

                    <section id="seccao-achievements" class="seccao">
                        <h1 class="titulo-seccao">Conquistas</h1>
                        <div id="achievements-grid" class="card-grid"></div>
                    </section>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <div id="video-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">√ó</span>
            <h3 id="modal-title"></h3>
            <div id="modal-video-container" class="modal-video-wrapper"></div>
        </div>
    </div>
    
    <div id="plan-execution-modal" class="modal">
        <div class="modal-content" style="max-width: 90vw; width: 600px; text-align: center;">
            <h3 id="plan-execution-title"></h3>
            <div id="plan-execution-timer-display" style="font-family: var(--font-destaque); font-size: 3rem; margin: 1rem 0;">20:00</div>
            <div class="progress-bar-container" style="height: 20px; margin-bottom: 1rem;">
                <div id="plan-execution-progress-bar" class="progress-bar-fill" style="background: var(--cor-descanso);"></div>
            </div>
            <div id="plan-execution-phase-info" style="margin-bottom: 1rem; color: var(--cor-texto-secundario); font-weight: bold;"></div>
            <div id="plan-execution-current-exercise"></div>
            <button id="stop-plan-btn" class="action-button" style="margin-top: 1.5rem; background: #c0392b; border-color: #c0392b;">Terminar Sess√£o</button>
        </div>
    </div>

    <div id="onboarding-modal" class="modal">
        <div class="onboarding-content">
            <h2 id="onboarding-title">Bem-vindo!</h2>
            <p id="onboarding-text">Este √© um pequeno guia para te ajudar a come√ßar.</p>
            <div class="onboarding-nav">
                <button id="onboarding-prev-btn" class="action-button" style="visibility: hidden;">Anterior</button>
                <div id="onboarding-dots"></div>
                <button id="onboarding-next-btn" class="action-button">Pr√≥ximo</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="hidden">
        <span id="notification-icon"></span>
        <span id="notification-text"></span>
    </div>
    
    <!-- Hidden file input for import -->
    <input type="file" id="import-file-input" style="display: none;" accept=".json,text/plain">

    <!-- Main Application Script -->
    <script type="module" src="app.js"></script>
</body>

</html>
